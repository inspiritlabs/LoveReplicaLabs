**REPLIT AI — THIS IS UNACCEPTABLE. FIX IT IMMEDIATELY.**

1. **Access-Code Enforcement Is Broken**
   • Right now, anyone can sign up with *any* email/password after entering one access code. That is the most BASIC security failure ever.
   • **Fix**: Tie each access code to exactly one user account. Once a code is used, reject any further registrations using that code. Do not allow multiple email/password combinations to bypass limits.

2. **User Credits & Messages Reset on Refresh or Relogin**
   • You must be joking. After a user spends their 5 messages, a simple page refresh or logging out/in resets their credits? That defeats the entire point.
   • **Fix**: Persist remaining credits and message count in the database on *every* chat send. On login or refresh, load the stored count. Do not allow client-side manipulation. If a user has used 5 messages, disable further sending—no exceptions.

3. **One Replica Per Account**
   • Right now people can spin up unlimited clones by creating new accounts with different emails after using a single code. That’s INSANE.
   • **Fix**: Enforce a one-to-one relationship between user account and replica. Once a user creates a replica, mark their account as “replica created.” Do not allow further replica creations—even if they refresh or log in from another device.

4. **Immediate Checks & Visible Errors**
   • When someone tries to reuse a code, show a clear error: “This access code has already been used.”
   • When message limit is reached, show “You have used all 5 messages. Upgrade or wait for next period.” Do not allow any further API calls or ghost UI.

5. **Audit All Flows Now**
   • Registration: Validate access code against used\_codes table.
   • Login: Fetch user’s message\_count and replica\_status from DB.
   • Chat Send: Before calling OpenAI/TTS, check message\_count < 5. If not, block.
   • Replica Creation: Before cloning voice, check replica\_status == false. If true, block.

6. **No More Excuses**
   • Every developer who says “it works” is lying. Test these flows yourself:

   1. Use a code to create an account → create a replica → send 5 messages.
   2. Refresh or log out/in → ensure you cannot send any more messages.
   3. Try to sign up a *new* account with the *same* access code → it must be rejected.
   4. Attempt to create a second replica under the same account → you must be blocked.

Redo this now. Do not push until this is bulletproof.
